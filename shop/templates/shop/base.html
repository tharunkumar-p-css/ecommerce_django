{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>FUNNELWEB â€” Modern E-commerce</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- âœ… Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- fonts + main CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Orbitron:wght@600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="{% static 'shop/style.css' %}">

  <link rel="stylesheet" href="{% static 'shop/responsive.css' %}">
   {% block extra_css %}{% endblock %}


  <script src="{% static 'shop/main.js' %}" defer></script>

  <style>
    :root { --accent: #0b6cff; --text-color: #111; }

    body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: var(--text-color);
      margin: 0;
      background: #fafafa;
    }

    /* Keep your container style */
 

    /* Header layout */
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      padding: 18px 0;
    }

    .brand-row {
      display: flex;
      align-items: center;
      gap: 16px;
      width: 100%;
    }

    .logo {
      font-weight: 800;
      font-size: 20px;
      text-decoration: none;
      color: var(--text-color);
      white-space: nowrap;
    }

    .search {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }

    .search input {
      padding: 10px 12px;
      border-radius: 20px;
      border: 1px solid #e6e6e6;
      width: 100%;
      max-width: 420px;
    }

    /* Top nav */
    .nav-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .nav-link {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 600;
      padding: 6px 8px;
      border-radius: 8px;
    }

    .nav-link:hover { color: var(--accent); }

    .offers-pill {
      background: linear-gradient(90deg,#fff6f8,#fff2f6);
      border: 1px solid #ffd7e0;
      color: #b91c1c;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 800;
    }

    /* categories dropdown */
    .dropdown { position: relative; }

    .dropdown-toggle {
      background: transparent;
      border: 0;
      font-weight: 700;
      cursor: pointer;
      padding: 6px 8px;
      font-size: 15px;
    }

    .dropdown-menu {
      position: absolute;
      right: 0;
      top: calc(100% + 8px);
      min-width: 220px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(11,24,64,0.12);
      padding: 8px 0;
      display: none;
      z-index: 999;
    }

    .dropdown.open .dropdown-menu { display: block; }

    .dropdown-menu li { list-style: none; }

    .dropdown-menu a {
      display: block;
      padding: 10px 14px;
      color: #222;
      text-decoration: none;
    }

    .dropdown-menu a:hover {
      background: rgba(11,108,255,0.06);
      color: var(--accent);
    }

    /* Common nav button style (like Offers) */
    .nav-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 18px;
      border-radius: 999px;
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
      line-height: 1;
      transition: all 0.2s ease;
    }

    /* Login button */
    .nav-btn-login {
      background: #ffffff;
      color: #1e293b;
      border: 1px solid #d0d7de;
    }

    .nav-btn-login:hover {
      background: #f1f5f9;
      border-color: #94a3b8;
      text-decoration: none;
    }

    /* Common tab */
    .nav-tab {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      font-size: 14px;
      font-weight: 600;
      color: #1e293b;
      text-decoration: none;
      border-radius: 6px;
      transition: all 0.2s ease;
    }

    .nav-tab:hover {
      background: #f1f5f9;
      text-decoration: none;
    }

    /* Footer */
    .site-footer { margin-top: 48px; padding: 28px 0; background: transparent; color: #666;}

    .site-footer a,
    .site-footer a:visited {
      text-decoration: none !important;
      color: #343333 !important;
      font-weight: 600;
    }

    .site-footer a:hover {
      color: #0b6cff !important;
      text-decoration: none !important;
    }
@media (min-width: 992px){

  .site-footer .row{
    align-items: flex-start !important;
  }

  .site-footer .col-lg-6:first-child{
    padding-bottom: 0px;
  }

  .site-footer .col-lg-6:last-child{
    padding-top: 22px;
  }

  .site-footer .col-lg-6:last-child .d-flex{
    justify-content: flex-end !important;
  }

}
   
    /* ============================= */
    /* âœ… RESPONSIVE (MOBILE/TABLET)  */
    /* ============================= */

    html, body { overflow-x: hidden; }
    img { max-width: 100%; height: auto; }

    /* Desktop: keep navbar items in one line */
    @media (min-width: 992px) {
      .nav-actions {
        flex-wrap: nowrap;
        white-space: nowrap;
      }
    }

    /* Mobile/Tablet */
    @media (max-width: 991px) {

      .topbar {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
      }

      .brand-row {
        width: 100%;
        gap: 10px;
      }

      .search {
        flex: 1;
        width: 100%;
      }

      .search input {
        width: 100%;
        max-width: none;
      }

      /* Menu items vertical */
      .nav-actions {
        flex-direction: column;
        align-items: flex-start;
        width: 100%;
        gap: 10px;
        padding-top: 10px;
      }

      .nav-actions a,
      .nav-actions button {
        width: 100%;
        text-align: left;
      }

      /* Dropdown menu full width */
      .dropdown-menu {
        right: 8px;
        left: 8px;
        min-width: auto;
      }
    }

    /* Hamburger button */
    .navbar-toggler {
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 10px 12px;
      background: #fff;
    }

    .navbar-toggler:focus {
      box-shadow: none;
    }

    /* IMPORTANT: make bootstrap icon visible */
    .navbar-toggler-icon {
      background-image: var(--bs-navbar-toggler-icon-bg);
    }

  </style>
</head>

<body>

  <header class="site-header">

    <!-- âœ… navbar-light is IMPORTANT -->
    <nav class="navbar navbar-expand-lg navbar-light p-0">
      <div class="topbar container">

        <!-- left: brand + search + hamburger -->
        <div class="brand-row">

          <a href="{% url 'shop:product_list' %}" class="logo">ðŸ›’FUNNELWEB</a>

          <form action="{% url 'shop:product_list' %}" method="get" class="search" role="search" aria-label="Site search">
            <input name="q" placeholder="Search for shoes  , jackets, watches..." value="{{ request.GET.q|default:'' }}" aria-label="Search">
            <button type="submit" aria-label="Search" class="nav-link" style="border-radius:999px;background:transparent;padding:6px 8px;"></button>
          </form>

          <!-- Hamburger button (ONLY mobile/tablet) -->
          <button class="navbar-toggler d-lg-none ms-auto" type="button"
                  data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                  aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

        </div>

        <!-- right: nav actions -->
        <div class="collapse navbar-collapse" id="mainNavbar">
          <nav class="nav-actions ms-lg-auto mt-3 mt-lg-0" role="navigation" aria-label="Top navigation">

            {% with path=request.path %}
              {% if path == "/" %}

                <div class="dropdown" id="top-categories">
                  <button class="dropdown-toggle" id="catToggle">
                    Categories
                  </button>

                  <ul class="dropdown-menu" id="categories-menu">
                    <li>
                      <a href="{% url 'shop:product_list' %}">All</a>
                    </li>
                    <!-- JS will inject categories here -->
                  </ul>
                </div>

              {% else %}
                <a href="{% url 'shop:product_list' %}" class="nav-link">
                  Home
                </a>
              {% endif %}
            {% endwith %}

            {% if user.is_authenticated and not user.is_staff %}
              <a href="{% url 'shop:cart' %}" class="nav-tab nav-cart">
                ðŸ›’ Cart
              </a>
            {% endif %}

            <a href="{% url 'shop:offers' %}" class="nav-link offers-pill">Offers</a>

            {% if user.is_authenticated %}

              {% if user.is_authenticated and not user.is_staff %}
                <a href="{% url 'shop:dashboard' %}" class="nav-tab">Dashboard</a>
              {% endif %}

              {% if user.is_staff %}
                <a href="{% url 'admin:index' %}" class="nav-link">Admin</a>
              {% endif %}

              <a href="{% url 'shop:logout' %}" class="nav-link">Logout</a>

            {% else %}
              <a href="{% url 'shop:login' %}" class="nav-btn nav-btn-login">Login</a>
            {% endif %}

          </nav>
        </div>

      </div>
    </nav>

    {% block hero %}{% endblock %}
  </header>

  <main class="container site-main">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <div class="row g-3 align-items-center">

        <div class="col-lg-6 col-12">
          <h3 class="brand m-0">FUNNELWEB</h3>
          <p class="tagline m-0 mt-1 ">Modern e-commerce demo â€” built with Django</p>
        </div>

        <div class="col-lg-6 col-12">
          <div class="d-flex flex-wrap gap-3 justify-content-lg-end justify-content-start mt-2 mt-lg-0">
            <a href="{% url 'shop:contact' %}">Contact</a>
            <a href="{% url 'shop:about' %}">About</a>
            <a href="{% url 'shop:terms' %}">Terms & Conditions</a>
          </div>
        </div>

        <div class="col-12">
          <p class="footer-copy m-0 mt-3">Â© FUNNELWEB â€” All rights reserved</p>
        </div>

      </div>
    </div>
  </footer>

  <!-- Modal quick view -->
  <div id="quick-view" class="modal" aria-hidden="true">
    <div class="modal-panel" role="dialog" aria-modal="true" aria-label="Product quick view">
      <button class="modal-close" data-close aria-label="Close"
              style="float:right;background:transparent;border:0;font-size:18px;cursor:pointer;">âœ•</button>
      <div id="quick-view-content"></div>
    </div>
  </div>

  <div id="page-overlay" class="overlay" data-close></div>

  <!-- âœ… Bootstrap JS (REQUIRED for hamburger) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- JS: dynamic categories loader -->
  <script>
  (function(){
    const toggle = document.getElementById('catToggle');
    const wrapper = document.getElementById('top-categories');
    const menu = document.getElementById('categories-menu');
    if (!toggle || !wrapper || !menu) return;

    function addItem(name, url) {
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = url;
      a.textContent = name;
      a.style.display = 'block';
      a.style.padding = '10px 14px';
      a.style.color = '#222';
      a.style.textDecoration = 'none';
      li.appendChild(a);
      menu.appendChild(li);
    }

    let loaded = false;

    toggle.addEventListener('click', function(e) {
      e.stopPropagation();
      wrapper.classList.toggle('open');
      toggle.setAttribute('aria-expanded', wrapper.classList.contains('open'));

      if (loaded) return;
      fetch('{% url "shop:api_categories" %}')
        .then(resp => {
          if (!resp.ok) throw new Error('Network response not ok');
          return resp.json();
        })
        .then(data => {
          if (data && Array.isArray(data.categories)) {
            data.categories.forEach(function(cat){
              addItem(cat.name, cat.url);
            });
          }
          loaded = true;
        })
        .catch(err => {
          console.warn('Could not load categories:', err);
          loaded = true;
        });
    });

    document.addEventListener('click', (e) => {
      if (!wrapper.contains(e.target)) {
        wrapper.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        wrapper.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
      }
    });
  })();
  </script>

</body>
</html>